var randomImage=function(e){var a=$.extend({bucket:null,path:null,awsRegion:"eu-west-1",container:".random-image","default":null},e);if(null!==a.bucket&&null!==a.path&&null!==a["default"]){var n="<img src='"+a["default"]+"' class='random-image default' alt=''  />",t=function(e,a){var n=document.getElementsByTagName("head")[0],t=document.createElement("script");t.src=e;var s=!1;t.onload=t.onreadystatechange=function(){s||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(s=!0,a(),t.onload=t.onreadystatechange=null,n.removeChild(t))},n.appendChild(t)},s=function(){var e=navigator.userAgent.toLowerCase(),a=!0;return e.indexOf("msie")>-1?a=e.indexOf("msie 10")>-1?!0:!1:-1!==e.indexOf("chrome")&&parseFloat(e.substring(e.indexOf("chrome")+7).split(" ")[0])<28?a=!1:-1!==e.indexOf("safari")&&e.indexOf("version")&&parseFloat(e.substring(e.indexOf("version")+8).split(" ")[0])<5.1?a=!1:-1!==e.indexOf("opera")&&parseFloat(e.substring(e.indexOf("version")+8).split(" ")[0])<17?a=!1:-1!==e.indexOf("firefox")&&parseFloat(e.substring(e.indexOf("firefox")+8))<23&&(a=!1),a},i=function(e,a,t,s){AWS.config.update({accessKeyId:"AKIAJ3CTMVV7WBH5CO2Q",secretAccessKey:"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"}),AWS.config.region=t;var i={Bucket:e,Delimiter:"/",EncodingType:"url",Marker:"",MaxKeys:1e3,Prefix:a},o=new AWS.S3({sslEnabled:!0});o.listObjects(i,function(e,a){if(e)$(s).append(n);else{var t=[];if(0===a.Contents.length)$(s).append(n);else if(a.Contents.length>1){a.Contents.shift();for(var i=a.Contents,o=/^jpg|jpeg|gif|png$/,r=0,l=i.length;l>r;r++){var d=i[r].Key,c=d.split(".").pop().toLowerCase();-1===d.lastIndexOf("__w_")&&o.test(c)&&t.push(i[r])}var f=Math.floor(Math.random()*t.length),u="<img src='/"+t[f].Key+"' alt='' class='random-image random"+f+"' />";$(s).append(u)}}})};s()?"undefined"==typeof AWS?t("https://sdk.amazonaws.com/js/aws-sdk-2.1.27.min.js",function(){i(a.bucket,a.path,a.awsRegion,a.container)}):i(a.bucket,a.path,a.awsRegion,a.container):$(a.container).append(n)}else console.log('please define parameters bucket, path and default like {bucket: "my.bucket.com", path: "random/images/", default: "/random/images/default.jpg"}')};